const fdata={"data":[
  {                                                                                                                                                         
     "timestamp": "2025-01-05T23:04:22.456415",                                                                                                             
     "host_ip": "127.0.0.1",                                                                                                                                
     "host_port": "59368",                                                                                                                                  
     "host_name": null,                                                                                                                                     
     "user_agent": null,                                                                                                                                    
     "request": {                                                                                                                                           
        "method": "GET",                                                                                                                                    
        "path": "/"                                                                                                                                         
     },                                                                                                                                                     
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL / was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"                                                                                                                                              
  },                                                                                                                                                        
  {                                                                                                                                                         
     "timestamp": "2025-01-05T23:05:44.347845",                                                                                                             
     "host_ip": "127.0.0.1",                                                                                                                                
     "host_port": "52084",                                                                                                                                  
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL / was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.349777",
     "host_ip": "127.0.0.1",
     "host_port": "52106",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/.git/HEAD"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL /.git/HEAD was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.350297",
     "host_ip": "127.0.0.1",
     "host_port": "52156",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/robots.txt"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL /robots.txt was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.351214",
     "host_ip": "127.0.0.1",
     "host_port": "52144",
     "host_name": null,
     "user_agent": null,
     "request": {
        "method": "GET",
        "path": "/"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL / was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.351483",
     "host_ip": "127.0.0.1",
     "host_port": "52154",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/nmaplowercheck1736098544"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL /nmaplowercheck1736098544 was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.360898",
     "host_ip": "127.0.0.1",
     "host_port": "52134",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "POST",
        "path": "/"
     },
     "response": "OK\\r\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.361672",
     "host_ip": "127.0.0.1",
     "host_port": "52086",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "POST",
        "path": "/sdk"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL /sdk was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.363955",
     "host_ip": "127.0.0.1",
     "host_port": "52188",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/HNAP1"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL /HNAP1 was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.366842",
     "host_ip": "127.0.0.1",
     "host_port": "52204",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL / was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.368769",
     "host_ip": "127.0.0.1",
     "host_port": "52218",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/nmaplowercheck1736098544"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL /nmaplowercheck1736098544 was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.372421",
     "host_ip": "127.0.0.1",
     "host_port": "52242",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL / was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.373001",
     "host_ip": "127.0.0.1",
     "host_port": "52254",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/favicon.ico"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL /favicon.ico was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.374606",
     "host_ip": "127.0.0.1",
     "host_port": "52256",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/evox/about"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL /evox/about was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.376380",
     "host_ip": "127.0.0.1",
     "host_port": "52258",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL / was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.384803",
     "host_ip": "127.0.0.1",
     "host_port": "52302",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL / was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.391397",
     "host_ip": "127.0.0.1",
     "host_port": "52314",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "POST",
        "path": "/"
     },
     "response": "OK\\r\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.395162",
     "host_ip": "127.0.0.1",
     "host_port": "52334",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL / was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.404304",
     "host_ip": "127.0.0.1",
     "host_port": "52358",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL / was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.412915",
     "host_ip": "127.0.0.1",
     "host_port": "52370",
     "host_name": "localhost",
     "user_agent": "Mozilla/5.0 (compatible; Nmap Scripting Engine; https://nmap.org/book/nse.html)",
     "request": {
        "method": "GET",
        "path": "/"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL / was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.424159",
     "host_ip": "127.0.0.1",
     "host_port": "52382",
     "host_name": null,
     "user_agent": null,
     "request": {
        "method": "GET",
        "path": "/"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL / was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  },
  {
     "timestamp": "2025-01-05T23:05:44.532185",
     "host_ip": "127.0.0.1",
     "host_port": "52390",
     "host_name": "localhost",
     "user_agent": null,
     "request": {
        "method": "GET",
        "path": "/"
     },
     "response": "<!DOCTYPE HTML PUBLIC \"-//IETF//DTD HTML 2.0//EN\">\\n<html><head>\\n<title>404 Not Found</title>\\n</head><body>\\n<h1>Not Found</h1>\\n<p>The requested URL / was not found on this server.<br />\\n</p>\\n\\n<hr>\\n<address>Apache/2.4.9 (Ubuntu) Server at example.com Port 80</address>\\n</body></html>\\n\\n"
  }
],"status":200}

//--------------------------------------------------

const div1 = document.createElement("div");
div1.classList.add("Mychart");

const canvas1 = document.createElement("canvas");
canvas1.id = "mychart1";

div1.appendChild(canvas1);

document.body.appendChild(div1);

//---------------------------------------------------


const div2 = document.createElement("div");
div2.classList.add("Mychart");

const canvas2 = document.createElement("canvas");
canvas2.id = "mychart2";

div2.appendChild(canvas2);

document.body.appendChild(div2);

//----------------------------------------------------

const div3 = document.createElement("div");
div3.classList.add("Mychart");

const canvas3 = document.createElement("canvas");
canvas3.id = "mychart3";

div3.appendChild(canvas3);

document.body.appendChild(div3);

//-----------------------------------------------------

const div4 = document.createElement("div");
div4.classList.add("Mychart");

const canvas4 = document.createElement("canvas");
canvas4.id = "mychart4";

div4.appendChild(canvas4);

document.body.appendChild(div4);

//------------------------------------------------------

function countOccurrences(arr) {
  var countMap = new Map();
  
  for (var i = 0; i <arr.length; i++) {
      let item= arr[i].request.method;
      if (countMap.has(item)) {
          countMap.set(item, countMap.get(item) + 1);
      } else {
          countMap.set(item, 1);
      }
  }
  
  return countMap;
}
const meth =Object.fromEntries(countOccurrences(fdata.data));
const methkey= Object.keys(meth);
const methval=Object.values(meth);

//-------------------------------------------------------

function randRGBA() {
  const r = Math.floor(Math.random() * 256);
  const g = Math.floor(Math.random() * 256);
  const b = Math.floor(Math.random() * 256);
  const a = 0.75; // Alpha between 0 and 1
  return ` rgba(${r}, ${g}, ${b}, ${a}) `;
}
let bgcol1=[]
for(let i=0;i<methkey.length;i++){
   bgcol1.push(randRGBA());
}

//--------------------------------------------------------

const data0 = {
  labels: methkey,
  datasets: [{
    label: 'Methods',
    data: methval,
    backgroundColor: bgcol1,
    borderColor: [
      
    ],
    borderWidth: 1
  }]
};

// config 
const config0 = {
  type: 'pie',
  data:data0,
  options: {
    scales: {
      y: {
        beginAtZero: true
      }
    }
  }
};

// render init block
const myChart = new Chart(
  document.getElementById('mychart1'),
  config0
);
//----------------------------------------------------------

let bgcol2=[]
for(let i=0;i<methkey.length;i++){
  bgcol2.push(randRGBA());
}

//----------------------------------------------------------



function countOccurrences(arr) {
  var countMap = new Map();
  
  for (var i = 0; i <arr.length; i++) {
      let item= arr[i].request.path;
      if (countMap.has(item)) {
          countMap.set(item, countMap.get(item) + 1);
      } else {
          countMap.set(item, 1);
      }
  }
  
  return countMap;
}

const path =Object.fromEntries(countOccurrences(fdata.data));
const pathkey= Object.keys(path);
const pathval=Object.values(path);

//-----------------------------------------------------------

const data1 = {
  labels: pathkey,
  datasets: [{
    label: 'paths',
    data: pathval,
    backgroundColor: bgcol2,
    borderColor: [
      
    ],
    borderWidth: 1
  }]
};

// config 
const config1 = {
  type: 'pie',
  data: data1,
  options: {
    scales: {
      y: {
        beginAtZero: true
      }
    }
  }
};

// render init block
const myChart1 = new Chart(
  document.getElementById('mychart2'),
  config1
);

//-------------------------------------------------------------

function countOccurrences(arr) {
  var countMap = new Map();
  
  for (var i = 0; i <arr.length; i++) {
      let item= arr[i].host_name;
      if (countMap.has(item)) {
          countMap.set(item, countMap.get(item) + 1);
      } else {
          countMap.set(item, 1);
      }
  }
  
  return countMap;
}

const hostname =Object.fromEntries(countOccurrences(fdata.data));
const hostnkey= Object.keys(hostname);
const hostnval=Object.values(hostname);

//--------------------------------------------------------------

let bgcol3=[]
for(let i=0;i<methkey.length;i++){
  bgcol3.push(randRGBA());
}

//--------------------------------------------------------------

const data2 = {
  labels: hostnkey,
  datasets: [{
    label: 'host_name',
    data: hostnval,
    backgroundColor: bgcol3,
    borderColor: [
      
    ],
    borderWidth: 1
  }]
};

// config 
const config2 = {
  type: 'pie',
  data: data2,
  options: {
    scales: {
      y: {
        beginAtZero: true
      }
    }
  }
};

// render init block
const myChart2 = new Chart(
  document.getElementById('mychart3'),
  config2
);

//-------------------------------------------------------------

function countOccurrences(arr) {
  var countMap = new Map();
  
  for (var i = 0; i <arr.length; i++) {
      let item= arr[i].host_ip;
      if (countMap.has(item)) {
          countMap.set(item, countMap.get(item) + 1);
      } else {
          countMap.set(item, 1);
      }
  }
  
  return countMap;
}

const ip =Object.fromEntries(countOccurrences(fdata.data));
const ipkey= Object.keys(ip);
const ipval=Object.values(ip);

//--------------------------------------------------------------

let bgcol4=[]
for(let i=0;i<methkey.length;i++){
  bgcol4.push(randRGBA());
}

//--------------------------------------------------------------

const data3 = {
  labels: ipkey,
  datasets: [{
    label: 'host_ip',
    data: ipval,
    backgroundColor: bgcol4,
    borderColor: [
      
    ],
    borderWidth: 1
  }]
};

// config 
const config3 = {
  type: 'pie',
  data: data3,
  options: {
    scales: {
      y: {
        beginAtZero: true
      }
    }
  }
};

// render init block
const myChart3 = new Chart(
  document.getElementById('mychart4'),
  config3
);
